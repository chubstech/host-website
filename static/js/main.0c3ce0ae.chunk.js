(this["webpackJsonpchart-demo"]=this["webpackJsonpchart-demo"]||[]).push([[0],{183:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(34),c=n.n(o),i=(n(82),n(9)),l=n(10),s=n(12),u=n(11),h=n(13),m=(n(53),n(83),n(74)),d=n(26),p=n(27),b=n(21),f=n(19),v=n(14),g=n.n(v);var E=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){fetch("https://cors-anywhere.herokuapp.com/https://noise-wearable.herokuapp.com/api/users").then((function(e){return e.json()})).then((function(e){return e})).then((function(e){var t=JSON.stringify(e);t=JSON.parse(t),console.log(t);t.map((function(e){console.log(e.user_id);(function(e){var t="https://cors-anywhere.herokuapp.com/https://noise-wearable.herokuapp.com/api/noise_observation/user/";return t+=e,fetch(t).then((function(e){return e.json()})).then((function(e){return e}))})(e.user_id).then((function(t){var n=JSON.stringify(t);n=JSON.parse(n);var a=Math.floor((new Date).getTime()/1e3),r=Math.round(a-7200),o=n.filter((function(e){if(e.time_obs>=r&&e.time_obs<a)return e.time_obs}));console.log(o);var c=new Object;o.map((function(e){var t,n,a,r=function(e){var t=e.getHours(),n=e.getMinutes(),a=t>=12?"pm":"am";return(t=(t%=12)||12)+":"+(n=n<10?"0"+n:n)+" "+a}(new Date(1e3*e.time_obs));t=r,n=e.db_reading,t in(a=c)?a[t]<n&&(a[t]=n):a[t]=n}));var i=document.createElement("canvas"),l="chart"+e.user_id;i.id=l;var s=document.createElement("H2"),u=document.createTextNode(e.user_id);s.appendChild(u),document.querySelector("#chartContainer").appendChild(s),document.querySelector("#chartContainer").appendChild(i);var h=document.getElementById(l).getContext("2d");window[l]=new g.a(h,{type:"line",data:{labels:Object.keys(c).reverse(),datasets:[{label:"DB Levels",data:Object.values(c).reverse()}]},options:{title:{display:!0,text:e.user_id},scales:{xAxes:[{ticks:{maxTicksLimit:20}}],yAxes:[{ticks:{beginAtZero:!0}}]}}})}))}))}))}},{key:"render",value:function(){return r.a.createElement("div",null)}}]),t}(r.a.Component);r.a.Component;var y=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Noise Manager WebApp"),r.a.createElement("p",null,"Real time data of each section/device"),r.a.createElement("div",{id:"chartContainer"},r.a.createElement(E,null)))};var k=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Math.round(Date.now()/1e3)-43200;fetch("https://cors-anywhere.herokuapp.com/https://noise-wearable.herokuapp.com/api/users").then((function(e){return e.json()})).then((function(e){return e})).then((function(t){var n=JSON.stringify(t);(n=JSON.parse(n)).map((function(t){(function(e){var t="https://cors-anywhere.herokuapp.com/https://noise-wearable.herokuapp.com/api/noise_observation/user/";return t+=e,fetch(t).then((function(e){return e.json()})).then((function(e){return e}))})(t.user_id).then((function(n){var a=JSON.stringify(n),r=(a=JSON.parse(a)).filter((function(t){return t.time_obs>=e})),o=0,c=0,i={};r.forEach((function(e,t){c+=e.db_reading,e.db_reading>o&&(o=e.db_reading);var n=new Date(1e3*e.time_obs);i[e.db_reading]?i[e.db_reading].push(n.toLocaleString()):i[e.db_reading]=[n.toLocaleString()]})),document.getElementById("table").insertAdjacentHTML("beforeend","<tr><td>"+t.user_id+"</td><td>"+Math.round(c/a.length)+"</td><td>"+o+"</td><td>"+i[o]+"</tr>")}))}))}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h3",null,"Daily Summary Table"),r.a.createElement("table",null,r.a.createElement("tbody",{id:"table"},r.a.createElement("tr",null,r.a.createElement("th",{id:"table-header"},"Section Name"),r.a.createElement("th",{id:"table-header"},"Average dB"),r.a.createElement("th",{id:"table-header"},"Peak dB"),r.a.createElement("th",{id:"table-header"},"Peak dB Time")))))}}]),t}(r.a.Component),w=n(71),M=n(35),O=0;function j(e){for(var t=[],n=0,a=0,r=0,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=0;c<e.length;c++){var i=new Date(1e3*e[c].time_obs);0==n?n=i.getHours():i.getHours()!=n?(t.push([Math.round(a/r),n]),n=i.getHours(),a=0,r=0):c==e.length-1&&t.push([Math.round(a/r),n]),a+=e[c].db_reading,r++}for(var l=0;l<t.length;l++){o[t[l][1]]=t[l][0]}return o}var _={showScale:!0,pointDot:!0,title:{display:!0,text:"Average Noise Levels (Hourly)",fontSize:20},scales:{yAxes:[{scaleLabel:{display:!0,labelString:"Noise (dB) Levels"}}]}};var S=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).changeText=function(){"Weekly Report"==n.state.text?n.setState({text:"Daily Report"}):n.setState({text:"Weekly Report"})},n.chartReference=r.a.createRef(),n.label=["12AM","1AM","2AM","3AM","4AM","5AM","6AM","7AM","8AM","9AM","10AM","11AM","12PM","1PM","2PM","3PM","4PM","5PM","6PM","7PM","8PM","9PM","10PM","11PM"],n.state={text:"Weekly Report",chartData:{labels:n.label,datasets:[]},json_files:[]},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=[];fetch("https://cors-anywhere.herokuapp.com/https://noise-wearable.herokuapp.com/api/users").then((function(e){return e.json()})).then((function(e){return e})).then((function(n){var a=JSON.stringify(n);(a=JSON.parse(a)).forEach((function(n,r){var o;(o=n.user_id,fetch("https://cors-anywhere.herokuapp.com/https://noise-wearable.herokuapp.com/api/noise_observation/user/"+o).then((function(e){return e.json()})).then((function(e){return e}))).then((function(n){var r=JSON.stringify(n),o=function(e,t){var n=["rgb(25, 129, 102)","rgba(171,185,255)","rgb(19, 72, 250)","rgb(174, 255, 171)","rgb(255, 205, 139)","rgb(252, 58, 113)","rgb(232, 222, 46)","rgb(178, 62, 207)","rgb(158, 56, 5)"],a={label:t,fill:!1,backgroundColor:n[O],borderColor:n[O],data:j(e)};return O++,a}(r=JSON.parse(r),r[0].user_id);if(t.push(o),t.length==a.length)return e.setState({chartData:{datasets:t}}),t}))}))}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"lineChart"},r.a.createElement(w.a,{ref:this.chartReference,data:this.state.chartData,options:_,height:250,width:600}),r.a.createElement("div",{class:"btn btn-info"},r.a.createElement(M.a,{id:"reportbutton",variant:"info",size:"sm",onClick:function(){e.changeText()}},this.state.text)))}}]),t}(r.a.Component),x=function(){var e=new Date;return r.a.createElement("div",null,r.a.createElement("div",{className:"no-print print-btn"},r.a.createElement(M.a,{variant:"info",size:"lg",onClick:function(e){e.preventDefault(),window.print()}},"Print report")),r.a.createElement("h1",null,"Your Noise Report Summary"),r.a.createElement("p",null,"Generated on ",r.a.createElement("b",null,e.toLocaleDateString())),r.a.createElement(S,null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(k,null))},A=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Help"),r.a.createElement("p",null,"Please contact UCI's team Chubby Cats."),r.a.createElement("p",null,"ziv@uci.edu"))},C=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(m.a,null,r.a.createElement(b.a,{basename:"/"},r.a.createElement(d.a,{bg:"dark",variant:"dark",expand:"sm"},r.a.createElement(d.a.Brand,{as:b.b,to:"/"},"React Demo App"),r.a.createElement(d.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(d.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(p.a,{className:"mr-auto"},r.a.createElement(p.a.Link,{as:b.c,to:"/host-website"},"Home"),r.a.createElement(p.a.Link,{as:b.c,to:"/report"},"Report"),r.a.createElement(p.a.Link,{as:b.c,to:"/help"},"Help")))),r.a.createElement("br",null),r.a.createElement(f.d,null,r.a.createElement(f.b,{exact:!0,path:"/host-website",component:y}),r.a.createElement(f.b,{exact:!0,path:"/report",component:x}),r.a.createElement(f.b,{exact:!0,path:"/help",component:A}),r.a.createElement(f.a,{from:"/",to:"/host-website"}))))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(b.a,null,r.a.createElement(C,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},53:function(e,t,n){},77:function(e,t,n){e.exports=n(183)},82:function(e,t,n){}},[[77,1,2]]]);
//# sourceMappingURL=main.0c3ce0ae.chunk.js.map